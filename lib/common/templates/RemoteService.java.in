package de.rwth_aachen.awap.service.remote;

import de.rwth_aachen.awap.Agent;
import de.rwth_aachen.awap.Message;
import de.rwth_aachen.awap.RemoteAgent;
import de.rwth_aachen.awap.RemoteService;
import de.rwth_aachen.awap.ServiceProperty;

public final class {{service.name}} extends RemoteService {
	public {{service.name}}(Agent parent, RemoteAgent remoteAgent, byte remoteServiceId) {
		super(parent, remoteAgent, remoteServiceId);
	}

	public static boolean registerListener(Agent agent, ServiceProperty... properties) {
		if(agent instanceof I{{service.name}}Client) {
			agent.df.installServiceListener(agent, (byte){{ service.id }}, properties);
			return true;
		} else {
			return false;
		}
	}

	// properties that can be used to register a listener
%% for prop in service.properties
	public static class {{ prop.name }}Property extends ServiceProperty {
		public {{ prop.java.type }} value;
		public {{ prop.name }}Property({{ prop.java.type }} value) {
			this.value = value;
		}
	}
%% endfor

	// message handlers
%% for msg in service.messages
	%# Remember, that tx and rx are reversed, now that we are the client!
	%% if msg.tx
	public static class {{ msg.name }} extends Message {
	%% for field in msg.fields
			public {{ field.java.type }} {{ field.name }};
	%% endfor
	}
	%% endif
	%# Remember, that tx and rx are reversed, now that we are the client!
	%% if msg.rx
	public static class {{ msg.name }} extends Message {
	%% for field in msg.fields
			public {{ field.java.type }} {{ field.name }};
	%% endfor
			public {{ msg.name }}({{ msg.java.args|join(', ') }}){
		%% for field in msg.fields
				this.{{ field.name }} = {{ field.name}};
		%% endfor
			}
	}
	public void send({{ msg.name }} msg) {
		msg.serviceId = this.remoteServiceId;
		msg.remoteService = true;
		msg.remoteAgent = this.remoteAgent;
		this.parent.com.send(msg);
	}
	%% endif
%% endfor
}

